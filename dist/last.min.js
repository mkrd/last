(()=>{var C=[["m","margin"],["mt","margin-top"],["mb","margin-bottom"],["ml","margin-left"],["mr","margin-right"],["p","padding"],["pt","padding-top"],["pb","padding-bottom"],["pl","padding-left"],["pr","padding-right"],["flex","display.flex"],["flow","display.flex flex-flow"],["justify-content","display.flex justify-content"],["align-items","display.flex align-items"],["align-content","display.flex align-content"],["grow","flex-grow"],["shrink","flex-shrink"],["w","width"],["h","height"],["min-w","min-width"],["min-h","min-height"],["max-w","max-width"],["max-h","max-height"],["pos","position"],["pos.abs","position.absolute"],["pos.rel","position.relative"],["t","top"],["b","bottom"],["l","left"],["r","right"],["z","z-index"],["bg","background"],["bg-color","background-color"],["header","font-size.3rem font-weight.800"],["tiny","transform.scale(0.5)"]];function z(e){let t=e.map(n=>n[0]).filter((n,o,s)=>s.indexOf(n)!==o);if(t.length>0)throw new Error(`Duplicate substitution shortcuts: ${t.join(", ")}`);return Object.fromEntries(e)}var O=z(C),h=O;var p={substitutions:h,config:{mode:"global",log:!1}};function j(e){if(!e)throw new Error("Assertion failed");console.log("assertion passed")}function k(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((n,o)=>n===t[o])}function r(...e){!p.config.log||console.log(...e)}var d={};function m(e){if(!!p.config.log)if(e in d){let t=performance.now()-d[e];console.log(`${e} - ${t.toFixed(1)}ms`),delete d[e]}else d[e]=performance.now()}function b(e,t,n={}){e.dispatchEvent(new CustomEvent(t,{detail:n,bubbles:!0,composed:!0,cancelable:!0}))}var A=0;function E(){let e=`${A}`;return A++,e}function f(e,t){return e.filter(n=>t.includes(n))}j(k(f([1,2,3],[2,3,4]),[2,3]));j(k(f([1,2,3],[4,5,6]),[]));var g=class{name;ui_tag;modifiers;init;events;constructor(t){this.name=t.name,this.ui_tag=t.ui_tag,this.modifiers={},"modifiers"in t&&(this.modifiers=t.modifiers),this.init=t.init,this.events=t.events}};r("\u{1FA83} Parse components/button");var q={name:"button",ui_tag:"bg-color.var(--ui-primary-color) color.#fff border.none p.10px border-radius.5px font-size.18px font-weight.bold cursor.pointer",modifiers:{secondary:"bg-color.var(--ui-secondary-color)"},init:e=>{r("Init button",e)},events:{click:e=>{r("Clicked button",e.target)}}};var _={};function S(e){if(r("\u{1F590}","Register component",e.name),e.name in _)throw new Error(`Cannot register component with name ${e.name} because a component with that name already exists`);if(e.name in h)throw new Error(`Cannot register component with name ${e.name} because a substitution with that name already exists`);_[e.name]=new g(e)}S(q);function L(e){let t=[];for(let n of e){let o=n.getAttribute("ui").split(" "),s=!1;for(let i of o)i.match(/^\d+$/)&&(s=!0);s||t.push(n)}return t}function M(e,t){let n=[...e.querySelectorAll(t)],o=e.querySelectorAll("template");for(let s of o)n=n.concat([...s.content.querySelectorAll(t)]);return n}function T(e,t){return[...new Map(e.map(n=>[t(n),n])).values()]}function w(e){let t=e.split("."),n=t[0],o=t.slice(1).join("."),s=!1;for(var i=0;i<o.length;i++){if("()".includes(o[i])){s=o[i]==="(";continue}!s&&o[i]==="."&&(o=o.substring(0,i)+" "+o.substring(i+1))}return{property:n,value:o}}function y(e){let t=[];for(let n of e.split(" ")){if(n in lastcss.substitutions){for(let s of lastcss.substitutions[n].split(" "))t.push(w(s));continue}let o=n.split(".")[0];if(o in lastcss.substitutions){let s=lastcss.substitutions[o]+n.substring(o.length);for(let i of s.split(" "))t.push(w(i));continue}t.push(w(n))}return T(t,n=>n.property)}var x=class{element;ui_tag_list;component;used_component_modifiers;constructor(t){this.element=t,this.ui_tag_list=t.getAttribute("ui").split(" "),t.removeAttribute("ui")}extract_component_properties=()=>{let t=f(this.ui_tag_list,Object.keys(_));if(t.length>1)throw new Error(`Cannot apply multiple ui components to one element. Choose one from: ${t.join(", ")}`);if(t.length===0){this.component=null;return}this.component=_[t[0]],this.ui_tag_list=this.ui_tag_list.filter(n=>n!==this.component.shortcut),this.used_component_modifiers=f(this.ui_tag_list,Object.keys(this.component.modifiers)),this.ui_tag_list=this.ui_tag_list.filter(n=>!this.used_component_modifiers.includes(n))};apply_component_functions=()=>{if(!!this.component){if(console.log(this.element),"init"in this.component&&this.component.init(this.element),"events"in this.component)for(let t in this.component.events)this.element.addEventListener(t,this.component.events[t]);this.element.setAttribute("ui",`${this.component.name} ${this.used_component_modifiers.join(" ")}`)}};apply_style_inline=()=>{let t=this.ui_tag_list.join(" ");for(let{property:n,value:o}of y(t))this.element.style[n]=o}},v=class{elements;constructor(t){this.elements=[];for(let n of t){let o=new x(n);o.extract_component_properties(),this.elements.push(o)}}make_global_component_style_sheet=()=>{let t={};for(let o of this.elements){if(!o.component)continue;let s=`[ui~="${o.component.name}"]`;s in t||(t[s]=y(o.component.ui_tag).map(i=>`${i.property}:${i.value};
`).join(""));for(let i of o.used_component_modifiers){let a=`:where([ui~="${o.component.name}"])[ui~="${i}"]`;if(!(a in t)){let u=y(o.component.modifiers[i]).map(l=>`${l.property}:${l.value};
`).join("");t[a]=u}}}var n=document.createElement("style");n.innerHTML=Object.entries(t).map(o=>`${o[0]}{
${o[1]}}`).join(""),document.head.insertBefore(n,document.head.querySelector("style"))};apply_component_functions=()=>{for(let t of this.elements)t.apply_component_functions()};apply_styles_inline=()=>{for(let t of this.elements)t.apply_style_inline()};apply_styles_global=()=>{let t=this.elements,n={};for(let i of t){let a=i.ui_tag_list.join(" "),c="";for(let{property:u,value:l}of y(a))c+=`${u}:${l};`;c in n?n[c].push(i):n[c]=[i]}let o=Object.entries(n).map(([i,a],c)=>{let u=E();return a.map(l=>l.element.setAttribute("ui",[l.element.getAttribute("ui")??"",u].join(" "))),`[ui~="${u}"]{
${i.split(";").join(`;
`)}}`}).join(`
`);var s=document.createElement("style");s.innerHTML=o,document.head.appendChild(s)}};function $(){m("\u{1F7E3}\u{1F3C1} Apply styles");let e=M(document,"[ui]");e=L(e);let t=new v(e);t.make_global_component_style_sheet(),t.apply_component_functions(),lastcss.config.mode==="global"?t.apply_styles_global():lastcss.config.mode==="inline"&&t.apply_styles_inline(),m("\u{1F7E3}\u{1F3C1} Apply styles")}window.lastcss=p;if(!document.body)throw new Error("Unable to initialize Last CSS. Do not use the <script> tag in the header, but rater after the <body> tag");r("\u{1F7E3} Last: start init");m("Last init");b(document,"last:init");p.refresh=$;$();b(document,"last:initialized");m("Last init");})();
