<html>
<head>
    <title>Test</title>
    <style>

    </style>
</head>
<body>
    <h1 !m.30px !flex-flow.row.nowrap !justify-content.center !color.green>
        Test
    </h1>
    <p !flex !justify-content.center !flex-grow.1 !color.#333333 !mt.100px>
        This is a test page.
    </p>

</body>
<script>

    function expand_shortcuts(s) {
        // Flex
        if (s === "flex") return "display.flex"
        // Margins
        if (s.startsWith("m."))  return "margin" + s.substring(1)
        if (s.startsWith("mt.")) return "margin-top" + s.substring(2)
        if (s.startsWith("mb.")) return "margin-bottom" + s.substring(2)
        if (s.startsWith("ml.")) return "margin-left" + s.substring(2)
        if (s.startsWith("mr.")) return "margin-bottom" + s.substring(2)

        return s
    }

    function apply_style(element, exclamation_style) {
        exclamation_style = exclamation_style.substring(1)

        var style_array = exclamation_style.split('!')
        for (var style of style_array) {
            style = expand_shortcuts(style)
            const style_name = style.split('.')[0]
            const style_value = style.split('.').slice(1).join(' ')

            console.log(style_name, style_value)
            element.style[style_name] = style_value
        }

    }

    const ui = [...document.querySelectorAll("*")].filter(
        e => [...e.attributes].some(a => a.name.startsWith("!"))
    )

    console.log(ui)

    for (const ele of ui) {
        for (const style_attr of ele.attributes) {
            if (style_attr.name.startsWith("!")) {
                console.log("apply style", style_attr.name)
                apply_style(ele, style_attr.name)
            }
        }
    }

</script>
</html>
